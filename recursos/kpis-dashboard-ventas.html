<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Automatizar reportes con IA en Excel (Gu√≠a paso a paso)</title>
  <meta name="description" content="Gu√≠a pr√°ctica para automatizar reportes en Excel usando IA (Copilot), Power Query, Office Scripts y Power Automate. Incluye ejemplos, prompts y c√≥digo listo para usar." />
  <style>
    :root{
      --bg:#0f172a; /* slate-900 */
      --card:#111827ee; /* gray-900 */
      --muted:#cbd5e1; /* slate-300 */
      --accent:#22d3ee; /* cyan-400 */
      --accent-2:#a78bfa; /* violet-400 */
      --ok:#34d399; /* emerald-400 */
      --warn:#fbbf24; /* amber-400 */
      --danger:#f87171; /* red-400 */
      --code:#0b1020;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:linear-gradient(180deg,#0b1220,#0f172a 40%,#0b1220);color:#e5e7eb;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;line-height:1.6}
    header{position:sticky;top:0;backdrop-filter: blur(8px);background:#0b1020cc;border-bottom:1px solid #1f2937}
    .wrap{max-width:1100px;margin:auto;padding:24px}
    .title{font-size:clamp(1.4rem,2vw+1rem,2.4rem);font-weight:800;letter-spacing:.3px;}
    .subtitle{color:var(--muted)}
    .grid{display:grid;gap:18px}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:900px){.grid.cols-2{grid-template-columns:1fr}}
    section{margin:28px 0}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:18px;padding:20px;box-shadow:0 20px 60px #0004}
    h2{font-size:1.6rem;margin:0 0 12px}
    h3{font-size:1.15rem;margin:20px 0 8px;color:#e2e8f0}
    p.lead{font-size:1.1rem;color:#e2e8f0}
    .pill{display:inline-block;padding:.3rem .6rem;border-radius:999px;border:1px solid #334155;color:#cbd5e1;background:#0b1020;margin-right:.4rem;font-size:.8rem}
    .tag{border-color:#243b53}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;background:#0b1220;border:1px solid #263449;border-radius:8px;padding:.2rem .45rem}
    code, pre{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
    pre{background:var(--code);color:#e5e7eb;border:1px solid #1f2937;padding:16px;border-radius:14px;overflow:auto}
    .callout{border-left:4px solid var(--accent);padding:12px 14px;background:#0b1220;border-radius:12px;border:1px solid #1f2937}
    .callout.warn{border-left-color:var(--warn)}
    .callout.ok{border-left-color:var(--ok)}
    .steps{counter-reset:step}
    .steps .step{position:relative;padding-left:52px;margin:22px 0}
    .steps .step:before{counter-increment:step;content:counter(step);position:absolute;left:0;top:0;width:36px;height:36px;display:grid;place-items:center;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));font-weight:800;color:#0b1220}
    details{border:1px solid #1f2937;border-radius:14px;padding:12px 14px;background:#0b1220}
    details summary{cursor:pointer;font-weight:700}
    .badge{font-weight:700;color:#0b1020;background:linear-gradient(135deg,var(--accent),var(--accent-2));padding:.2rem .45rem;border-radius:8px}
    .toc a{color:#93c5fd;text-decoration:none}
    .toc a:hover{text-decoration:underline}
    footer{border-top:1px solid #1f2937;color:#94a3b8}
    .mono{font-family:ui-monospace,Consolas,monospace}
    .center{text-align:center}
    .responsive{max-width:100%;height:auto;border-radius:12px;border:1px solid #1f2937}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="title">Automatizar reportes con <span class="badge">IA</span> en Excel</div>
      <div class="subtitle">Gu√≠a pr√°ctica y lista para publicar ‚Äî de 0 a un flujo 100% autom√°tico con Copilot, Power Query, Office Scripts y Power Automate.</div>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <h2>üí° Objetivo</h2>
      <p class="lead">Configurar un <strong>pipeline de reporte en Excel</strong> que: (1) se actualice solo desde la fuente de datos, (2) genere visuales y KPIs, (3) redacte <em>insights</em> autom√°ticos con <strong>IA (Copilot)</strong> y (4) <strong>env√≠e</strong> el reporte final por correo o lo guarde como PDF/Excel en la nube.</p>
      <div class="grid cols-2">
        <div>
          <h3>üß∞ Requisitos</h3>
          <ul>
            <li>Microsoft 365 con Excel de escritorio (preferible) y acceso a <strong>Copilot</strong>.</li>
            <li>Conectar a OneDrive/SharePoint para el archivo final.</li>
            <li>Fuentes de datos (CSV, Excel, DB o API) y permisos.</li>
          </ul>
        </div>
        <div>
          <h3>üöÄ Resultado</h3>
          <ul>
            <li>Archivo <span class="mono">Reporte.xlsx</span> con pesta√±as <em>Datos</em>, <em>Modelo</em>, <em>Dashboard</em>, <em>Insights IA</em>.</li>
            <li>Script que refresca, actualiza visuales y exporta a PDF/Excel.</li>
            <li>Flujo programado que distribuye el reporte autom√°ticamente.</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>√çndice</h2>
      <ol class="toc">
        <li><a href="#datos">Preparar y limpiar datos con Power Query</a></li>
        <li><a href="#modelo">Modelo, KPIs y tablas din√°micas</a></li>
        <li><a href="#dashboard">Dashboard con gr√°ficos</a></li>
        <li><a href="#copilot">Generar insights con IA (Copilot)</a></li>
        <li><a href="#script">Automatizar con Office Scripts (refresh & export)</a></li>
        <li><a href="#flow">Programar distribuci√≥n con Power Automate</a></li>
        <li><a href="#plus">Opcionales: Par√°metros, Python en Excel y control de calidad</a></li>
        <li><a href="#troubleshoot">Soluci√≥n de problemas</a></li>
      </ol>
    </section>

    <section id="datos" class="card">
      <h2>1) Preparar y limpiar datos con Power Query</h2>
      <div class="steps">
        <div class="step">
          <strong>Conectar</strong> ‚Üí <span class="kbd">Datos &gt; Obtener datos</span> (CSV/Excel/SQL/API). Cargar como <em>Solo crear conexi√≥n</em> y habilitar <em>Agregar al modelo de datos</em> si usar√°s medidas.
        </div>
        <div class="step">
          <strong>Transformar</strong>: abrir <span class="kbd">Transformar datos</span> y aplicar pasos: tipo de datos, dividir/combinar columnas, quitar nulos, normalizar texto, crear columnas personalizadas.
        </div>
        <div class="step">
          <strong>Par√°metros</strong> (opcional): en Power Query, <em>Administrar par√°metros</em> para rutas/fechas. √ötil para mover el archivo sin romper conexiones.
        </div>
      </div>
      <details>
        <summary>üìé Dataset de ejemplo (CSV)</summary>
        <pre>fecha,region,producto,vendedor,unidades,precio
2025-07-01,Centro,A,Mar√≠a,12,150
2025-07-01,Norte,B,Carlos,9,200
2025-07-02,Sur,A,Luis,5,150
2025-07-03,Centro,C,Mar√≠a,7,300
2025-07-04,Norte,A,Ana,10,150
2025-07-05,Sur,B,Pedro,4,200
</pre>
      </details>
      <div class="callout"><strong>Tip:</strong> Nombra las consultas de Power Query con prefijos (p.ej. <span class="mono">fct_Ventas</span>, <span class="mono">dim_Producto</span>) para mantener orden.</div>
    </section>

    <section id="modelo" class="card">
      <h2>2) Modelo, KPIs y tablas din√°micas</h2>
      <p>En la hoja <strong>Modelo</strong> crea tus medidas (si usas el Modelo de datos) o columnas calculadas. Para un enfoque directo en Excel, puedes usar <em>Tablas din√°micas</em> desde el rango/consulta.</p>
      <div class="grid cols-2">
        <div>
          <h3>Medidas b√°sicas (Ejemplos)</h3>
          <ul>
            <li><span class="mono">Unidades Totales</span>: suma de <em>unidades</em>.</li>
            <li><span class="mono">Ingresos</span>: suma de <em>unidades * precio</em>.</li>
            <li><span class="mono">Ticket Promedio</span>: <em>Ingresos / Unidades</em>.</li>
          </ul>
        </div>
        <div>
          <h3>Tabla din√°mica</h3>
          <ol>
            <li>Insertar &gt; Tabla din√°mica &gt; Fuente: <em>consulta Power Query</em>.</li>
            <li>Filas: <em>fecha (mes)</em> ‚Ä¢ Columnas: <em>regi√≥n</em> ‚Ä¢ Valores: <em>Ingresos</em>.</li>
            <li>Habilitar segmentadores (slicers) para <em>producto</em> y <em>vendedor</em>.</li>
          </ol>
        </div>
      </div>
      <div class="callout ok">Con Copilot puedes pedir: <em>‚ÄúCrea una tabla din√°mica con ingresos por mes y regi√≥n y agrega un gr√°fico de columnas.‚Äù</em></div>
    </section>

    <section id="dashboard" class="card">
      <h2>3) Dashboard con gr√°ficos</h2>
      <p>En la hoja <strong>Dashboard</strong>, inserta gr√°ficos (columnas, l√≠neas, mapa si aplica). Nombra rangos para facilitar scripting.</p>
      <ul>
        <li>Selecciona estilos consistentes y usa formato condicional para KPIs (verde ‚ñ≤, rojo ‚ñº).</li>
        <li>Agrega un encabezado con el per√≠odo (p.ej., <em>√öltimos 30 d√≠as</em>).</li>
        <li>Bloque ‚ÄúKPIs‚Äù: Ingresos, Unidades, Ticket Promedio, Top producto/Regi√≥n.</li>
      </ul>
    </section>

    <section id="copilot" class="card">
      <h2>4) Generar <em>insights</em> con IA (Copilot)</h2>
      <p>Abre Copilot en Excel y utiliza <strong>prompts contextuales</strong> para obtener explicaciones, tendencias y res√∫menes que se actualizan con tus datos.</p>
      <h3>Prompts recomendados</h3>
      <ul>
        <li>‚ÄúAnaliza la tabla <span class="mono">fct_Ventas</span> y resume en 5 puntos las principales tendencias del √∫ltimo mes.‚Äù</li>
        <li>‚Äú¬øQu√© regiones explican el 80% de los ingresos? Devu√©lvelo en una tabla.‚Äù</li>
        <li>‚ÄúGenera un texto ejecutivo (80-120 palabras) con hallazgos y recomendaciones accionables.‚Äù</li>
        <li>‚ÄúProp√≥n 3 alertas autom√°ticas basadas en umbrales (ej., ca√≠da &gt; 15% intermensual).‚Äù</li>
      </ul>
      <div class="callout warn"><strong>Privacidad:</strong> Evita incluir datos sensibles en los prompts. Usa muestras o vistas con campos m√≠nimos necesarios.</div>
      <h3>Insertar resultados en la hoja</h3>
      <p>Pide a Copilot: ‚ÄúEscribe el resumen en la hoja <em>Insights IA</em>, celda A2‚Äù. Luego da formato con estilo de informe.</p>
    </section>

    <section id="script" class="card">
      <h2>5) Automatizar con Office Scripts (Refresh & Export)</h2>
      <p>En Excel para la Web: <span class="kbd">Automatizar &gt; Nuevo script</span>. Usa el siguiente script para <strong>refrescar consultas</strong> y <strong>exportar a PDF</strong> y <strong>guardar una copia Excel</strong>.</p>
      <h3>Script listo para usar</h3>
      <pre><code class="language-ts">/**
 * Office Script: Refresh & Export
 * - Refresca todas las conexiones/consultas
 * - Actualiza tablas din√°micas
 * - Exporta a PDF (hoja "Dashboard")
 * - Guarda copia con timestamp
 */
async function main(workbook: ExcelScript.Workbook) {
  const date = new Date();
  const yyyy = date.getFullYear();
  const mm = String(date.getMonth()+1).padStart(2,"0");
  const dd = String(date.getDate()).padStart(2,"0");
  const hh = String(date.getHours()).padStart(2,"0");
  const mi = String(date.getMinutes()).padStart(2,"0");
  const stamp = `${yyyy}${mm}${dd}-${hh}${mi}`;

  // 1) Refrescar conexiones/consultas
  try {
    workbook.refreshAllDataConnections();
  } catch(e) { console.log("No data connections or refresh failed:", e); }

  // 2) Actualizar tablas din√°micas
  try {
    const pivots = workbook.getPivotTables();
    pivots.forEach(p => p.refresh());
  } catch(e) { console.log("No pivot tables or refresh failed:", e); }

  // 3) Exportar a PDF solo la hoja Dashboard
  const dashboard = workbook.getWorksheet("Dashboard");
  if (dashboard) {
    const exportOptions: ExcelScript.WorkbookPdfExportOptions = {
      // Ajusta seg√∫n tus m√°rgenes/√°rea
      onlySelectedWorksheet: true,
      includeDocumentProperties: true,
      scale: 90
    };
    await workbook.getApplication().createPdf(exportOptions);
  }

  // 4) Guardar una copia con timestamp
  const fileName = `Reporte_Automatizado_${stamp}.xlsx`;
  await workbook.saveAs({
    fileName,
    conflictResolution: ExcelScript.SaveConflictResolution.replace,
  });
}
</code></pre>
      <div class="callout">Ajusta el nombre de la hoja de salida (p.ej., <span class="mono">"Dashboard"</span>) y el <em>scale</em> hasta que el PDF quede perfecto.</div>
    </section>

    <section id="flow" class="card">
      <h2>6) Programar distribuci√≥n con Power Automate</h2>
      <ol class="steps">
        <li class="step"><strong>Disparador</strong>: ‚ÄúRecurrente‚Äù (p.ej., cada lunes 08:00).</li>
        <li class="step"><strong>Acci√≥n: Ejecutar script de Excel Online (Business)</strong> ‚Üí selecciona el archivo en OneDrive/SharePoint y el script <span class="mono">main</span>.</li>
        <li class="step"><strong>Acci√≥n: Obtener archivo</strong> (PDF/Excel) desde la misma carpeta.</li>
        <li class="step"><strong>Acci√≥n: Enviar correo (Outlook)</strong> con adjunto o <strong>Guardar archivo</strong> en SharePoint/Teams con nombre <span class="mono">Reporte_Automatizado_{a√±o}{mes}{d√≠a}.pdf</span>.</li>
      </ol>
      <div class="callout ok">Suma l√≥gica condicional: si ‚ÄúIngresos &lt; Objetivo‚Äù entonces notifica a gerencia con asunto ‚ö†Ô∏è.</div>
    </section>

    <section id="plus" class="card">
      <h2>7) Opcionales potentes</h2>
      <h3>Par√°metros de per√≠odo</h3>
      <p>Crea una hoja <em>Config</em> con celdas <span class="mono">FechaInicio</span> y <span class="mono">FechaFin</span>. √ösalas en Power Query para filtrar.</p>
      <h3>Python en Excel</h3>
      <p>Para modelos de pron√≥stico o clasificaci√≥n, inserta una celda Python (Excel) y calcula predicciones. Exporta resultados a una tabla y con√©ctala al dashboard.</p>
      <pre><code># Ejemplo m√≠nimo en una celda Python (pseudoc√≥digo)
import pandas as pd
# df = xl("fct_Ventas")  # referencia a una Tabla de Excel
# pronostico = tu_modelo(df)
# xlw("Pronostico", pronostico)  # volcar salida a Excel
</code></pre>
      <h3>Control de calidad</h3>
      <ul>
        <li>Valida tipos de datos en Power Query.</li>
        <li>Agrega pruebas simples (conteos, totales) y comp√°ralos con per√≠odos previos.</li>
        <li>Usa formato condicional para destacar outliers.</li>
      </ul>
    </section>

    <section id="troubleshoot" class="card">
      <h2>8) Soluci√≥n de problemas</h2>
      <ul>
        <li><strong>Conexi√≥n falla:</strong> verifica credenciales y or√≠genes en <em>Consultas y conexiones</em>.</li>
        <li><strong>PDF en blanco:</strong> aseg√∫rate de seleccionar la hoja correcta y ajustar el √°rea de impresi√≥n.</li>
        <li><strong>Copilot no responde bien:</strong> pide tablas intermedias, limita columnas y refina el prompt con contexto concreto.</li>
        <li><strong>Lentitud:</strong> deshabilita c√°lculos vol√°tiles, reduce pasos de PQ y usa columnas de tipo entero/fecha.</li>
      </ul>
      <div class="callout warn">Recuerda mantener tus datos en OneDrive/SharePoint para que los flujos puedan acceder y no dependan de tu PC encendida.</div>
    </section>

    <section class="card center">
      <h2>üéØ Checklist final</h2>
      <p>
        <span class="pill">Datos conectados</span>
        <span class="pill">KPIs y pivots</span>
        <span class="pill">Dashboard</span>
        <span class="pill">Insights IA</span>
        <span class="pill">Script de refresh</span>
        <span class="pill">Flujo programado</span>
      </p>
      <p class="lead">Tu reporte ahora <strong>se actualiza y se distribuye solo</strong>. Enf√≥cate en la estrategia, no en el trabajo repetitivo. üöÄ</p>
    </section>
  </main>

  <footer class="wrap">
    <p>Escrito para profesionales que desean acelerar su anal√≠tica en Excel con IA. Mant√©n la gu√≠a a mano y mej√≥rala seg√∫n tus procesos.</p>
  </footer>
</body>
</html>
